<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>10.10.&nbsp;Session&#21047;&#20986;(flush)</title>
      <link rel="stylesheet" href="css/html.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
      <link rel="start" href="index.html" title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;">
      <link rel="up" href="objectstate.html" title="&#31532;&nbsp;10&nbsp;&#31456;&nbsp;&#19982;&#23545;&#35937;&#20849;&#20107;">
      <link rel="prev" href="objectstate-replicating.html" title="10.9.&nbsp;&#22312;&#20004;&#20010;&#19981;&#21516;&#25968;&#25454;&#24211;&#38388;&#22797;&#21046;&#23545;&#35937;">
      <link rel="next" href="objectstate-transitive.html" title="10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)">
   </head>
   <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
      <div class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center">10.10.&nbsp;Session&#21047;&#20986;(flush)</th>
            </tr>
            <tr>
               <td width="20%" align="left"><a accesskey="p" href="objectstate-replicating.html">&#19978;&#19968;&#39029;</a>&nbsp;
               </td>
               <th width="60%" align="center">&#31532;&nbsp;10&nbsp;&#31456;&nbsp;&#19982;&#23545;&#35937;&#20849;&#20107;</th>
               <td width="20%" align="right">&nbsp;<a accesskey="n" href="objectstate-transitive.html">&#19979;&#19968;&#39029;</a></td>
            </tr>
         </table>
         <hr>
      </div>
      <div class="sect1" lang="zh-CN">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both"><a name="objectstate-flushing"></a>10.10.&nbsp;Session&#21047;&#20986;(flush)
                  </h2>
               </div>
            </div>
         </div>
         <p>&#27599;&#38388;&#38548;&#19968;&#27573;&#26102;&#38388;&#65292;<code class="literal">Session</code>&#20250;&#25191;&#34892;&#19968;&#20123;&#24517;&#38656;&#30340;SQL&#35821;&#21477;&#26469;&#25226;&#20869;&#23384;&#20013;&#30340;&#23545;&#35937;&#30340;&#29366;&#24577;&#21516;&#27493;&#21040;JDBC&#36830;&#25509;&#20013;&#12290;&#36825;&#20010;&#36807;&#31243;&#34987;&#31216;&#20026;<span class="emphasis"><em>&#21047;&#20986;(flush)</em></span>&#65292;&#40664;&#35748;&#20250;&#22312;&#19979;&#38754;&#30340;&#26102;&#38388;&#28857;&#25191;&#34892;&#65306; 
         </p>
         <div class="itemizedlist">
            <ul type="disc" compact>
               <li>
                  <p>&#22312;&#26576;&#20123;&#26597;&#35810;&#25191;&#34892;&#20043;&#21069; </p>
               </li>
               <li>
                  <p>&#22312;&#35843;&#29992;<code class="literal">org.hibernate.Transaction.commit()</code>&#30340;&#26102;&#20505; 
                  </p>
               </li>
               <li>
                  <p>&#22312;&#35843;&#29992;<code class="literal">Session.flush()</code>&#30340;&#26102;&#20505; 
                  </p>
               </li>
            </ul>
         </div>
         <p>&#28041;&#21450;&#30340;SQL&#35821;&#21477;&#20250;&#25353;&#29031;&#19979;&#38754;&#30340;&#39034;&#24207;&#21457;&#20986;&#25191;&#34892;&#65306; </p>
         <div class="orderedlist">
            <ol type="1" compact>
               <li>
                  <p>&#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#25554;&#20837;&#30340;&#35821;&#21477;&#65292;&#20854;&#39034;&#24207;&#25353;&#29031;&#23545;&#35937;&#25191;&#34892;<code class="literal">Session.save()</code>&#30340;&#26102;&#38388;&#39034;&#24207; 
                  </p>
               </li>
               <li>
                  <p>&#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#26356;&#26032;&#30340;&#35821;&#21477; </p>
               </li>
               <li>
                  <p>&#25152;&#26377;&#36827;&#34892;&#38598;&#21512;&#21024;&#38500;&#30340;&#35821;&#21477; </p>
               </li>
               <li>
                  <p>&#25152;&#26377;&#23545;&#38598;&#21512;&#20803;&#32032;&#36827;&#34892;&#21024;&#38500;&#65292;&#26356;&#26032;&#25110;&#32773;&#25554;&#20837;&#30340;&#35821;&#21477; </p>
               </li>
               <li>
                  <p>&#25152;&#26377;&#36827;&#34892;&#38598;&#21512;&#25554;&#20837;&#30340;&#35821;&#21477; </p>
               </li>
               <li>
                  <p>&#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#21024;&#38500;&#30340;&#35821;&#21477;&#65292;&#20854;&#39034;&#24207;&#25353;&#29031;&#23545;&#35937;&#25191;&#34892;<code class="literal">Session.delete()</code>&#30340;&#26102;&#38388;&#39034;&#24207; 
                  </p>
               </li>
            </ol>
         </div>
         <p>&#65288;&#26377;&#19968;&#20010;&#20363;&#22806;&#26159;&#65292;&#22914;&#26524;&#23545;&#35937;&#20351;&#29992;<code class="literal">native</code>&#26041;&#24335;&#26469;&#29983;&#25104;ID&#65288;&#25345;&#20037;&#21270;&#26631;&#35782;&#65289;&#30340;&#35805;&#65292;&#23427;&#20204;&#19968;&#25191;&#34892;save&#23601;&#20250;&#34987;&#25554;&#20837;&#12290;&#65289; 
         </p>
         <p>&#38500;&#38750;&#20320;&#26126;&#30830;&#22320;&#21457;&#20986;&#20102;<code class="literal">flush()</code>&#25351;&#20196;&#65292;&#20851;&#20110;Session<span class="emphasis"><em>&#20309;&#26102;</em></span>&#20250;&#25191;&#34892;&#36825;&#20123;JDBC&#35843;&#29992;&#26159;&#23436;&#20840;&#26080;&#27861;&#20445;&#35777;&#30340;&#65292;&#21482;&#33021;&#20445;&#35777;&#23427;&#20204;&#25191;&#34892;&#30340;&#21069;&#21518;&#39034;&#24207;&#12290; &#24403;&#28982;&#65292;Hibernate&#20445;&#35777;&#65292;<code class="literal">Query.list(..)</code>&#32477;&#23545;&#19981;&#20250;&#36820;&#22238;&#24050;&#32463;&#22833;&#25928;&#30340;&#25968;&#25454;&#65292;&#20063;&#19981;&#20250;&#36820;&#22238;&#38169;&#35823;&#25968;&#25454;&#12290; 
         </p>
         <p>&#20063;&#21487;&#20197;&#25913;&#21464;&#40664;&#35748;&#30340;&#35774;&#32622;&#65292;&#26469;&#35753;&#21047;&#20986;(flush)&#25805;&#20316;&#21457;&#29983;&#30340;&#19981;&#37027;&#20040;&#39057;&#32321;&#12290; <code class="literal">FlushMode</code>&#31867;&#23450;&#20041;&#20102;&#19977;&#31181;&#19981;&#21516;&#30340;&#26041;&#24335;&#12290; &#20165;&#22312;&#25552;&#20132;&#26102;&#21047;&#20986;(&#20165;&#24403;Hibernate&#30340;<code class="literal">Transaction</code> API&#34987;&#20351;&#29992;&#26102;&#26377;&#25928;)&#65292; &#25353;&#29031;&#21018;&#25165;&#35828;&#30340;&#26041;&#24335;&#21047;&#20986;&#65292; &#20197;&#21450;&#38500;&#38750;&#26126;&#30830;&#20351;&#29992;<code class="literal">flush()</code>&#21542;&#21017;&#20174;&#19981;&#21047;&#20986;&#12290; &#26368;&#21518;&#19968;&#31181;&#27169;&#24335;&#23545;&#20110;&#37027;&#20123;&#38656;&#35201;&#38271;&#26102;&#38388;&#20445;&#25345;<code class="literal">Session</code>&#20026;&#25171;&#24320;&#25110;&#32773;&#26029;&#32447;&#29366;&#24577;&#30340;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;&#24037;&#20316;&#21333;&#20803;&#24456;&#26377;&#29992;&#12290; (&#21442;&#35265; <a href="transactions-optimistic.html#transactions-optimistic-longsession" title="11.3.2.&nbsp;&#25193;&#23637;&#21608;&#26399;&#30340;session&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;">&#31532;&nbsp;11.3.2&nbsp;&#33410; &#8220;&#25193;&#23637;&#21608;&#26399;&#30340;session&#21644;&#33258;&#21160;&#29256;&#26412;&#21270;&#8221;</a>). 
         </p><pre class="programlisting">sess = sf.openSession();
Transaction tx = sess.beginTransaction();
sess.setFlushMode(FlushMode.COMMIT); // allow queries to return stale state

Cat izi = (Cat) sess.load(Cat.class, id);
izi.setName(iznizi);

// might return stale data
sess.find("from Cat as cat left outer join cat.kittens kitten");

// change to izi is not flushed!
...
tx.commit(); // flush occurs
sess.close();</pre><p>&#21047;&#20986;(flush)&#26399;&#38388;&#65292;&#21487;&#33021;&#20250;&#25243;&#20986;&#24322;&#24120;&#12290;&#65288;&#20363;&#22914;&#19968;&#20010;DML&#25805;&#20316;&#36829;&#21453;&#20102;&#32422;&#26463;&#65289; &#24322;&#24120;&#22788;&#29702;&#28041;&#21450;&#21040;&#23545;Hibernate&#20107;&#21153;&#24615;&#34892;&#20026;&#30340;&#29702;&#35299;&#65292;&#22240;&#27492;&#25105;&#20204;&#23558;&#22312;<a href="transactions.html" title="&#31532;&nbsp;11&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#21457;">&#31532;&nbsp;11&nbsp;&#31456; <i xmlns:xlink="http://www.w3.org/1999/xlink">&#20107;&#21153;&#21644;&#24182;&#21457;</i></a>&#20013;&#35752;&#35770;&#12290; 
         </p>
      </div>
      <div class="navfooter">
         <hr>
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left"><a accesskey="p" href="objectstate-replicating.html">&#19978;&#19968;&#39029;</a>&nbsp;
               </td>
               <td width="20%" align="center"><a accesskey="u" href="objectstate.html">&#19978;&#19968;&#32423;</a></td>
               <td width="40%" align="right">&nbsp;<a accesskey="n" href="objectstate-transitive.html">&#19979;&#19968;&#39029;</a></td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top">10.9.&nbsp;&#22312;&#20004;&#20010;&#19981;&#21516;&#25968;&#25454;&#24211;&#38388;&#22797;&#21046;&#23545;&#35937;&nbsp;</td>
               <td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td>
               <td width="40%" align="right" valign="top">&nbsp;10.11.&nbsp;&#20256;&#25773;&#24615;&#25345;&#20037;&#21270;(transitive persistence)</td>
            </tr>
         </table>
      </div>
   </body>
</html>