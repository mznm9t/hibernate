<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>19.4.&nbsp;&#26597;&#35810;&#32531;&#23384;&#65288;The Query Cache&#65289;</title>
      <link rel="stylesheet" href="css/html.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
      <link rel="start" href="index.html" title="HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;">
      <link rel="up" href="performance.html" title="&#31532;&nbsp;19&nbsp;&#31456;&nbsp;&#25552;&#21319;&#24615;&#33021;">
      <link rel="prev" href="performance-sessioncache.html" title="19.3.&nbsp;&#31649;&#29702;&#32531;&#23384;&#65288;Managing the caches&#65289;">
      <link rel="next" href="performance-collections.html" title="19.5.&nbsp;&#29702;&#35299;&#38598;&#21512;&#24615;&#33021;&#65288;Understanding Collection performance&#65289;">
   </head>
   <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
      <div class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center">19.4.&nbsp;&#26597;&#35810;&#32531;&#23384;&#65288;The Query Cache&#65289;</th>
            </tr>
            <tr>
               <td width="20%" align="left"><a accesskey="p" href="performance-sessioncache.html">&#19978;&#19968;&#39029;</a>&nbsp;
               </td>
               <th width="60%" align="center">&#31532;&nbsp;19&nbsp;&#31456;&nbsp;&#25552;&#21319;&#24615;&#33021;</th>
               <td width="20%" align="right">&nbsp;<a accesskey="n" href="performance-collections.html">&#19979;&#19968;&#39029;</a></td>
            </tr>
         </table>
         <hr>
      </div>
      <div class="sect1" lang="zh-CN">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both"><a name="performance-querycache"></a>19.4.&nbsp;&#26597;&#35810;&#32531;&#23384;&#65288;The Query Cache&#65289;
                  </h2>
               </div>
            </div>
         </div>
         <p>&#26597;&#35810;&#30340;&#32467;&#26524;&#38598;&#20063;&#21487;&#20197;&#34987;&#32531;&#23384;&#12290;&#21482;&#26377;&#24403;&#32463;&#24120;&#20351;&#29992;&#21516;&#26679;&#30340;&#21442;&#25968;&#36827;&#34892;&#26597;&#35810;&#26102;&#65292;&#36825;&#25165;&#20250;&#26377;&#20123;&#29992;&#22788;&#12290; &#35201;&#20351;&#29992;&#26597;&#35810;&#32531;&#23384;&#65292;&#39318;&#20808;&#20320;&#24517;&#39035;&#25171;&#24320;&#23427;&#65306; </p><pre class="programlisting">hibernate.cache.use_query_cache true</pre><p>&#35813;&#35774;&#32622;&#23558;&#20250;&#21019;&#24314;&#20004;&#20010;&#32531;&#23384;&#21306;&#22495; - &#19968;&#20010;&#29992;&#20110;&#20445;&#23384;&#26597;&#35810;&#32467;&#26524;&#38598;(<code class="literal">org.hibernate.cache.StandardQueryCache</code>)&#65307; &#21478;&#19968;&#20010;&#21017;&#29992;&#20110;&#20445;&#23384;&#26368;&#36817;&#26597;&#35810;&#30340;&#19968;&#31995;&#21015;&#34920;&#30340;&#26102;&#38388;&#25139;(<code class="literal">org.hibernate.cache.UpdateTimestampsCache</code>)&#12290; &#35831;&#27880;&#24847;&#65306;&#22312;&#26597;&#35810;&#32531;&#23384;&#20013;&#65292;&#23427;&#24182;&#19981;&#32531;&#23384;&#32467;&#26524;&#38598;&#20013;&#25152;&#21253;&#21547;&#30340;&#23454;&#20307;&#30340;&#30830;&#20999;&#29366;&#24577;&#65307;&#23427;&#21482;&#32531;&#23384;&#36825;&#20123;&#23454;&#20307;&#30340;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#20540;&#12289;&#20197;&#21450;&#21508;&#20540;&#31867;&#22411;&#30340;&#32467;&#26524;&#12290; &#25152;&#20197;&#26597;&#35810;&#32531;&#23384;&#36890;&#24120;&#20250;&#21644;&#20108;&#32423;&#32531;&#23384;&#19968;&#36215;&#20351;&#29992;&#12290; 
         </p>
         <p>&#32477;&#22823;&#22810;&#25968;&#30340;&#26597;&#35810;&#24182;&#19981;&#33021;&#20174;&#26597;&#35810;&#32531;&#23384;&#20013;&#21463;&#30410;&#65292;&#25152;&#20197;Hibernate&#40664;&#35748;&#26159;&#19981;&#36827;&#34892;&#26597;&#35810;&#32531;&#23384;&#30340;&#12290;&#22914;&#33509;&#38656;&#35201;&#36827;&#34892;&#32531;&#23384;&#65292;&#35831;&#35843;&#29992; <code class="literal">Query.setCacheable(true)</code>&#26041;&#27861;&#12290;&#36825;&#20010;&#35843;&#29992;&#20250;&#35753;&#26597;&#35810;&#22312;&#25191;&#34892;&#36807;&#31243;&#20013;&#26102;&#20808;&#20174;&#32531;&#23384;&#20013;&#26597;&#25214;&#32467;&#26524;&#65292; &#24182;&#23558;&#33258;&#24049;&#30340;&#32467;&#26524;&#38598;&#25918;&#21040;&#32531;&#23384;&#20013;&#21435;&#12290; 
         </p>
         <p>&#22914;&#26524;&#20320;&#35201;&#23545;&#26597;&#35810;&#32531;&#23384;&#30340;&#22833;&#25928;&#25919;&#31574;&#36827;&#34892;&#31934;&#30830;&#30340;&#25511;&#21046;&#65292;&#20320;&#24517;&#39035;&#35843;&#29992;<code class="literal">Query.setCacheRegion()</code>&#26041;&#27861;&#65292; &#20026;&#27599;&#20010;&#26597;&#35810;&#25351;&#23450;&#20854;&#21629;&#21517;&#30340;&#32531;&#23384;&#21306;&#22495;&#12290; 
         </p><pre class="programlisting">List blogs = sess.createQuery("from Blog blog where blog.blogger = :blogger")
    .setEntity("blogger", blogger)
    .setMaxResults(15)
    .setCacheable(true)
    .setCacheRegion("frontpages")
    .list();</pre><p>&#22914;&#26524;&#26597;&#35810;&#38656;&#35201;&#24378;&#34892;&#21047;&#26032;&#20854;&#26597;&#35810;&#32531;&#23384;&#21306;&#22495;&#65292;&#37027;&#20040;&#20320;&#24212;&#35813;&#35843;&#29992;<code class="literal">Query.setCacheMode(CacheMode.REFRESH)</code>&#26041;&#27861;&#12290; &#36825;&#23545;&#22312;&#20854;&#20182;&#36827;&#31243;&#20013;&#20462;&#25913;&#24213;&#23618;&#25968;&#25454;&#65288;&#20363;&#22914;&#65292;&#19981;&#36890;&#36807;Hibernate&#20462;&#25913;&#25968;&#25454;&#65289;&#65292;&#25110;&#23545;&#37027;&#20123;&#38656;&#35201;&#36873;&#25321;&#24615;&#26356;&#26032;&#29305;&#23450;&#26597;&#35810;&#32467;&#26524;&#38598;&#30340;&#24773;&#20917;&#29305;&#21035;&#26377;&#29992;&#12290; &#36825;&#26159;&#23545;<code class="literal">SessionFactory.evictQueries()</code>&#30340;&#26356;&#20026;&#26377;&#25928;&#30340;&#26367;&#20195;&#26041;&#26696;&#65292;&#21516;&#26679;&#21487;&#20197;&#28165;&#38500;&#26597;&#35810;&#32531;&#23384;&#21306;&#22495;&#12290; 
         </p>
      </div>
      <div class="navfooter">
         <hr>
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left"><a accesskey="p" href="performance-sessioncache.html">&#19978;&#19968;&#39029;</a>&nbsp;
               </td>
               <td width="20%" align="center"><a accesskey="u" href="performance.html">&#19978;&#19968;&#32423;</a></td>
               <td width="40%" align="right">&nbsp;<a accesskey="n" href="performance-collections.html">&#19979;&#19968;&#39029;</a></td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top">19.3.&nbsp;&#31649;&#29702;&#32531;&#23384;&#65288;Managing the caches&#65289;&nbsp;</td>
               <td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td>
               <td width="40%" align="right" valign="top">&nbsp;19.5.&nbsp;&#29702;&#35299;&#38598;&#21512;&#24615;&#33021;&#65288;Understanding Collection performance&#65289;</td>
            </tr>
         </table>
      </div>
   </body>
</html>